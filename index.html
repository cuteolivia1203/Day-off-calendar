<div class="header">
    <h2 style="margin:0; font-size: 1.2rem;">ğŸ“… Day off status and main events</h2>
    <div class="legend">
        <span class="badge bg-KGB200">KGB200</span><span class="badge bg-KGB210">KGB210</span>
        <span class="badge bg-KGB220">KGB220</span><span class="badge bg-KGB250">KGB250</span>
        <span class="badge" style="background:var(--EVENT)">Events</span>
    </div>
    
    <div style="margin-top:15px; display: flex; align-items: center; gap: 8px; position: relative;">
        <label style="font-weight: bold;">User:</label>
        
        <div class="dropdown-container">
            <div class="dropdown-selected" @click="toggleDropdown">
                <span :class="'dot bg-' + currentUser.Group"></span>
                {{ currentUser.Name }} ({{ currentUser.Group }})
                <span class="arrow">â–¼</span>
            </div>
            
            <div class="dropdown-list" v-if="isDropdownOpen">
                <div v-for="u in staff" 
                     :key="u.Email" 
                     class="dropdown-item" 
                     @click="selectUser(u)">
                    <span :class="'dot bg-' + u.Group"></span>
                    <span :style="{ color: 'var(--' + u.Group + ')' }">{{ u.Name }} ({{ u.Group }})</span>
                </div>
            </div>
        </div>
        
        <button @click="fetchData" style="width:auto; padding: 8px 12px; height: 42px;">Refresh</button>
    </div>
</div>

<style>
/* æ–°å¢è‡ªè¨‚é¸å–®çš„ CSS æ¨£å¼ */
.dropdown-container { position: relative; flex-grow: 1; user-select: none; }
.dropdown-selected {
    background: white; border: 1px solid #ddd; border-radius: 10px;
    padding: 10px 15px; cursor: pointer; display: flex; align-items: center;
    font-size: 1rem; height: 20px;
}
.dropdown-list {
    position: absolute; top: 110%; left: 0; right: 0; background: white;
    border: 1px solid #ddd; border-radius: 10px; box-shadow: 0 5px 15px rgba(0,0,0,0.1);
    z-index: 1000; max-height: 300px; overflow-y: auto;
}
.dropdown-item {
    padding: 12px 15px; display: flex; align-items: center; cursor: pointer;
    border-bottom: 1px solid #f5f5f5; font-weight: bold;
}
.dropdown-item:last-child { border-bottom: none; }
.dropdown-item:hover { background: #f0f7ff; }
.dot { width: 10px; height: 10px; border-radius: 50%; margin-right: 10px; flex-shrink: 0; }
.arrow { margin-left: auto; font-size: 0.7rem; color: #999; }
</style>

<script>
// åœ¨ Vue setup() å…§å¢åŠ é€™å…©å€‹æ§åˆ¶è®Šæ•¸èˆ‡å‡½æ•¸
const isDropdownOpen = ref(false);
const toggleDropdown = () => isDropdownOpen.value = !isDropdownOpen.value;
const selectUser = (u) => {
    currentUserEmail.value = u.Email;
    isDropdownOpen.value = false;
};

// è¨˜å¾—åœ¨ return è£œä¸Šé€™å¹¾å€‹æ–°çš„å±¬æ€§
return { 
    staff, currentUserEmail, currentUser, isDropdownOpen, 
    toggleDropdown, selectUser, // ... å…¶ä»–åŸæœ¬å°±æœ‰çš„
};
</script>
